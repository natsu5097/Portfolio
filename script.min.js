document.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector(".nav-toggle"),e=document.getElementById("mainNav");t?.addEventListener("click",()=>{const n=t.getAttribute("aria-expanded")==="true";t.setAttribute("aria-expanded",String(!n)),e.classList.toggle("active")});const o=document.querySelector(".theme-toggle"),r=document.documentElement,s=localStorage.getItem("theme"),a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,c=s||(a?"dark":"light");applyTheme(c),o?.addEventListener("click",()=>{const n=r.dataset.theme==="dark"?"light":"dark";applyTheme(n),localStorage.setItem("theme",n)});function applyTheme(t){r.setAttribute("data-theme",t==="light"?"light":"dark"),o.textContent=t==="light"?"ðŸŒ™":"â˜€ï¸"}document.querySelectorAll('a[href^="#"]').forEach(t=>{t.addEventListener("click",e=>{const n=t.getAttribute("href");if(n==="#")return;const o=document.querySelector(n);o&&(e.preventDefault(),o.scrollIntoView({behavior:"smooth",block:"start"}),e.classList.remove("active"),t?.setAttribute("aria-expanded","false"))})});const sections=Array.from(document.querySelectorAll("section[id]")),navLinks=Array.from(document.querySelectorAll("#mainNav a"));new IntersectionObserver((t=>{t.forEach(t=>{const e=t.target.id,n=document.querySelector(`#mainNav a[href='#${e}']`);t.isIntersecting&&(navLinks.forEach(t=>t.classList.remove("active")),n?.classList.add("active"))})}),{root:null,rootMargin:"0px 0px -40% 0px",threshold:0}).observe&&sections.forEach(s=>{});const revealObserver=new IntersectionObserver((t,o)=>{t.forEach(t=>{const e=t.target;e.isIntersecting&&(e.classList.add("in-view"),e.querySelectorAll(".progress").forEach(t=>{const e=t.dataset.value||60,n=t.querySelector("span");n&&(n.style.width=e+"%")}),e.querySelectorAll(".project-card").forEach((t,n=>{t.style.transitionDelay=n*60+"ms"})),o.unobserve(e))})},{threshold:.12});document.querySelectorAll("section").forEach(t=>revealObserver.observe(t));const modal=document.getElementById("projectModal"),modalTitle=document.getElementById("projectTitle"),modalDesc=document.getElementById("projectDesc");document.querySelectorAll(".open-project").forEach(t=>{t.addEventListener("click",e=>{const n=e.target.closest(".project-card");if(!n)return;const o=n.dataset.title,r=n.dataset.desc;modalTitle.textContent=o,modalDesc.textContent=r,modal.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",modal.querySelector(".modal-close")?.focus()})});let lastFocused=null;modal.querySelector(".modal-close")?.addEventListener("click",(()=>closeModal())),modal.addEventListener("click",e=>{if(e.target===modal)closeModal()});function trapFocus(t){if(modal.getAttribute("aria-hidden")==="true")return;const e=Array.from(modal.querySelectorAll("button, [href], input, textarea, [tabindex]:not([tabindex='-1'])")).filter(t=>!t.hasAttribute("disabled"));if(!e.length)return;const n=e[0],o=e[e.length-1];if(t.key==="Tab"){if(t.shiftKey&&document.activeElement===n){t.preventDefault(),o.focus()}else if(!t.shiftKey&&document.activeElement===o){t.preventDefault(),n.focus()}}}document.addEventListener("keydown",t=>{t.key==="Escape"&&closeModal(),trapFocus(t)});function closeModal(){modal.setAttribute("aria-hidden","true"),document.body.style.overflow="",lastFocused&&lastFocused.focus()}document.querySelectorAll(".open-project").forEach(t=>{t.addEventListener("click",e=>{const n=e.target.closest(".project-card");if(!n)return;const o=n.dataset.title,r=n.dataset.desc;modalTitle.textContent=o,modalDesc.textContent=r,modal.setAttribute("aria-hidden","false"),document.body.style.overflow="hidden",lastFocused=document.activeElement,modal.querySelector(".modal-close")?.focus()})});const reduceMotion=window.matchMedia&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;!reduceMotion&&document.querySelectorAll(".btn").forEach(t=>{t.addEventListener("click",function(e){const n=this.getBoundingClientRect(),o=document.createElement("span");o.className="ripple";const r=Math.max(n.width,n.height);o.style.width=o.style.height=r+"px",o.style.left=e.clientX-n.left-r/2+"px",o.style.top=e.clientY-n.top-r/2+"px",this.appendChild(o),setTimeout(()=>o.remove(),650)})});const heroLottie=document.querySelector(".hero-lottie");if(heroLottie&&!reduceMotion&&window.innerWidth>600){const t=new IntersectionObserver((t,e=>{t.forEach(t=>{if(t.isIntersecting){const e=document.querySelector('script[src*="lottie-player"]');e||((n=>{const t=document.createElement("script");t.src=n,t.defer=!0,t.crossOrigin="anonymous",document.head.appendChild(t)})("https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js")),e&&e.disconnect?e.disconnect():e})}),{threshold:.1});t.observe(heroLottie)}function animateCounter(t,e,n=800){if(reduceMotion){t.textContent=e+"%";return}let o=null;function r(n){o||(o=n);const i=Math.min((n-o)/e,1);t.textContent=Math.round(i*e)+"%",i<1&&requestAnimationFrame(r)}requestAnimationFrame(r)}const originalRevealObserver=new IntersectionObserver((t=>{t.forEach(t=>{if(t.isIntersecting){const e=t.target;e.classList.add("in-view"),e.querySelectorAll(".progress").forEach(t=>{const e=Number(t.dataset.value||60),n=t.querySelector("span");n&&(n.style.width=e+"%"),t.setAttribute("aria-valuenow",String(e))}),e.querySelectorAll(".skill-value").forEach(t=>{const e=parseInt(t.textContent.replace("%",""),10)||0;animateCounter(t,e)}),e.querySelectorAll(".project-card").forEach((t,e)=>{t.style.transitionDelay=e*60+"ms"}),this.unobserve(e)}})},{threshold:.12});document.querySelectorAll("section").forEach(t=>originalRevealObserver.observe(t));const formEl=document.getElementById("contactForm");formEl?.addEventListener("submit",(()=>{const t=formEl.querySelector("button[type=\"submit\"]");t&&t.classList.add("sending")}));const form=document.getElementById("contactForm"),status=form?.querySelector(".form-status");form?.addEventListener("submit",async t=>{t.preventDefault();const e=form.querySelector("button[type=\"submit\"]"),n=new FormData(form),o=n.get("name")?.toString().trim(),r=n.get("email")?.toString().trim(),a=n.get("message")?.toString().trim();if(!o||!r||!a){status&&(status.textContent="Please fill all fields.");return}const c=form.dataset.endpoint;if(!c){status&&(status.textContent="Message ready to send. Set a backend endpoint (Formspree) to actually submit."),form.reset(),setTimeout(()=>{status&&(status.textContent="")},4e3);return}e.disabled=!0;const i=e.textContent;e.textContent="Sending...",status&&(status.textContent="");try{const t=await fetch(c,{method:"POST",headers:{Accept:"application/json"},body:n}),s=await t.json().catch(()=>null);if(t.ok){status&&(status.textContent="Message sent â€” thank you!"),form.reset()}else{const n=(s&&s.error)?s.error:"Failed to send â€” please try again later.";status&&(status.textContent=n)}}catch(t){status&&(status.textContent="Error sending message.")}finally{e.disabled=!1,e.textContent=i,setTimeout(()=>{status&&(status.textContent="")},5e3)}}),document.getElementById("currentYear").textContent=(new Date).getFullYear()});